{
  "attack_id": "G1034",
  "notes": null,
  "created": "25 July 2024",
  "modified": "31 October 2024",
  "name": "Daggerfly",
  "version": "1.0",
  "contributors_list": [
    "Furkan Celik, PURE7"
  ],
  "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) is a People's Republic of China-linked APT entity active since at least 2012. [Daggerfly](https://attack.mitre.org/groups/G1034) has targeted individuals, government and NGO entities, and telecommunication companies in Asia and Africa. [Daggerfly](https://attack.mitre.org/groups/G1034) is associated with exclusive use of [MgBot](https://attack.mitre.org/software/S1146) malware and is noted for several potential supply chain infection campaigns.(Citation: Symantec Daggerfly 2023)(Citation: ESET EvasivePanda 2023)(Citation: Symantec Daggerfly 2024)(Citation: ESET EvasivePanda 2024)",
  "technique_table_data": [
    {
      "domain": "enterprise",
      "id": "T1071",
      "name": "Application Layer Protocol",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "001",
          "name": "Web Protocols",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) uses HTTP for command and control communication.(Citation: ESET EvasivePanda 2024)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1059",
      "name": "Command and Scripting Interpreter",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "001",
          "name": "PowerShell",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) used PowerShell to download and execute remote-hosted files on victim systems.(Citation: Symantec Daggerfly 2023)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1584",
      "name": "Compromise Infrastructure",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "004",
          "name": "Server",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) compromised web servers hosting updates for software as part of a supply chain intrusion.(Citation: ESET EvasivePanda 2024)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1136",
      "name": "Create Account",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "001",
          "name": "Local Account",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) created a local account on victim machines to maintain access.(Citation: Symantec Daggerfly 2023)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1587",
      "name": "Develop Capabilities",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "002",
          "name": "Code Signing Certificates",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) created code signing certificates to sign malicious macOS files.(Citation: ESET EvasivePanda 2024)",
          "subtechniques": []
        }
      ]
    },
    {
      "technique_used": true,
      "domain": "enterprise",
      "id": "T1189",
      "name": "Drive-by Compromise",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has used strategic website compromise for initial access against victims.(Citation: ESET EvasivePanda 2024)",
      "subtechniques": []
    },
    {
      "domain": "enterprise",
      "id": "T1574",
      "name": "Hijack Execution Flow",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "001",
          "name": "DLL",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has used legitimate software to side-load [PlugX](https://attack.mitre.org/software/S0013) loaders onto victim systems.(Citation: Symantec Daggerfly 2023) [Daggerfly](https://attack.mitre.org/groups/G1034) is also linked to multiple other instances of side-loading for initial loading activity.(Citation: ESET EvasivePanda 2024)",
          "subtechniques": []
        }
      ]
    },
    {
      "technique_used": true,
      "domain": "enterprise",
      "id": "T1105",
      "name": "Ingress Tool Transfer",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has used PowerShell and [BITSAdmin](https://attack.mitre.org/software/S0190) to retrieve follow-on payloads from external locations for execution on victim machines.(Citation: Symantec Daggerfly 2023)",
      "subtechniques": []
    },
    {
      "domain": "enterprise",
      "id": "T1036",
      "name": "Masquerading",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "003",
          "name": "Rename Legitimate Utilities",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) used a renamed version of rundll32.exe, such as \"dbengin.exe\" located in the `ProgramData\\Microsoft\\PlayReady` directory, to proxy malicious DLL execution.(Citation: Symantec Daggerfly 2023)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1003",
      "name": "OS Credential Dumping",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "002",
          "name": "Security Account Manager",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) used [Reg](https://attack.mitre.org/software/S0075) to dump the Security Account Manager (SAM) hive from victim machines for follow-on credential extraction.(Citation: Symantec Daggerfly 2023)",
          "subtechniques": []
        }
      ]
    },
    {
      "technique_used": true,
      "domain": "enterprise",
      "id": "T1012",
      "name": "Query Registry",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) used [Reg](https://attack.mitre.org/software/S0075) to dump the Security Account Manager (SAM), System, and Security Windows registry hives from victim machines.(Citation: Symantec Daggerfly 2023)",
      "subtechniques": []
    },
    {
      "domain": "enterprise",
      "id": "T1053",
      "name": "Scheduled Task/Job",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "005",
          "name": "Scheduled Task",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has attempted to use scheduled tasks for persistence in victim environments.(Citation: ESET EvasivePanda 2024)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1553",
      "name": "Subvert Trust Controls",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "002",
          "name": "Code Signing",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has used signed, but not notarized, malicious files for execution in macOS environments.(Citation: ESET EvasivePanda 2024)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1195",
      "name": "Supply Chain Compromise",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "002",
          "name": "Compromise Software Supply Chain",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) is associated with several supply chain compromises using malicious updates to compromise victims.(Citation: ESET EvasivePanda 2023)(Citation: ESET EvasivePanda 2024)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1218",
      "name": "System Binary Proxy Execution",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "011",
          "name": "Rundll32",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) proxied execution of malicious DLLs through a renamed rundll32.exe binary.(Citation: Symantec Daggerfly 2023)",
          "subtechniques": []
        }
      ]
    },
    {
      "technique_used": true,
      "domain": "enterprise",
      "id": "T1082",
      "name": "System Information Discovery",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) utilizes victim machine operating system information to create custom User Agent strings for subsequent command and control communication.(Citation: ESET EvasivePanda 2024)",
      "subtechniques": []
    },
    {
      "domain": "enterprise",
      "id": "T1204",
      "name": "User Execution",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "001",
          "name": "Malicious Link",
          "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has used strategic website compromise to deliver a malicious link requiring user interaction.(Citation: ESET EvasivePanda 2024)",
          "subtechniques": []
        }
      ]
    }
  ],
  "campaign_data": [],
  "add_campaign_ref": false,
  "software_data": [
    {
      "id": "S0190",
      "name": "BITSAdmin",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has used [BITSAdmin](https://attack.mitre.org/software/S0190) to retrieve files from remote locations to run on victim systems.(Citation: Symantec Daggerfly 2023)",
      "techniques": [
        {
          "id": "T1197",
          "name": "BITS Jobs"
        },
        {
          "parent_id": "T1048",
          "id": "003",
          "name": "Exfiltration Over Alternative Protocol",
          "sub_name": "Exfiltration Over Unencrypted Non-C2 Protocol"
        },
        {
          "id": "T1105",
          "name": "Ingress Tool Transfer"
        },
        {
          "id": "T1570",
          "name": "Lateral Tool Transfer"
        }
      ]
    },
    {
      "id": "S1016",
      "name": "MacMa",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) is linked to the use and potentially development of [MacMa](https://attack.mitre.org/software/S1016) through overlapping command and control infrastructure and shared libraries with other unique tools.(Citation: Symantec Daggerfly 2024)",
      "techniques": [
        {
          "id": "T1123",
          "name": "Audio Capture"
        },
        {
          "parent_id": "T1059",
          "id": "004",
          "name": "Command and Scripting Interpreter",
          "sub_name": "Unix Shell"
        },
        {
          "parent_id": "T1543",
          "id": "001",
          "name": "Create or Modify System Process",
          "sub_name": "Launch Agent"
        },
        {
          "parent_id": "T1555",
          "id": "001",
          "name": "Credentials from Password Stores",
          "sub_name": "Keychain"
        },
        {
          "id": "T1005",
          "name": "Data from Local System"
        },
        {
          "parent_id": "T1074",
          "id": "001",
          "name": "Data Staged",
          "sub_name": "Local Data Staging"
        },
        {
          "id": "T1140",
          "name": "Deobfuscate/Decode Files or Information"
        },
        {
          "id": "T1573",
          "name": "Encrypted Channel"
        },
        {
          "id": "T1041",
          "name": "Exfiltration Over C2 Channel"
        },
        {
          "id": "T1083",
          "name": "File and Directory Discovery"
        },
        {
          "parent_id": "T1070",
          "id": "002",
          "name": "Indicator Removal",
          "sub_name": "Clear Linux or Mac System Logs"
        },
        {
          "parent_id": "T1070",
          "id": "006",
          "name": "Indicator Removal",
          "sub_name": "Timestomp"
        },
        {
          "parent_id": "T1070",
          "id": "004",
          "name": "Indicator Removal",
          "sub_name": "File Deletion"
        },
        {
          "id": "T1105",
          "name": "Ingress Tool Transfer"
        },
        {
          "parent_id": "T1056",
          "id": "001",
          "name": "Input Capture",
          "sub_name": "Keylogging"
        },
        {
          "id": "T1106",
          "name": "Native API"
        },
        {
          "id": "T1095",
          "name": "Non-Application Layer Protocol"
        },
        {
          "id": "T1571",
          "name": "Non-Standard Port"
        },
        {
          "id": "T1057",
          "name": "Process Discovery"
        },
        {
          "id": "T1021",
          "name": "Remote Services"
        },
        {
          "id": "T1113",
          "name": "Screen Capture"
        },
        {
          "parent_id": "T1553",
          "id": "002",
          "name": "Subvert Trust Controls",
          "sub_name": "Code Signing"
        },
        {
          "parent_id": "T1553",
          "id": "001",
          "name": "Subvert Trust Controls",
          "sub_name": "Gatekeeper Bypass"
        },
        {
          "id": "T1082",
          "name": "System Information Discovery"
        },
        {
          "id": "T1016",
          "name": "System Network Configuration Discovery"
        },
        {
          "id": "T1033",
          "name": "System Owner/User Discovery"
        }
      ]
    },
    {
      "id": "S1146",
      "name": "MgBot",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) is uniquely associated with the use of [MgBot](https://attack.mitre.org/software/S1146) since at least 2012.(Citation: ESET EvasivePanda 2023)",
      "techniques": [
        {
          "parent_id": "T1087",
          "id": "002",
          "name": "Account Discovery",
          "sub_name": "Domain Account"
        },
        {
          "parent_id": "T1087",
          "id": "001",
          "name": "Account Discovery",
          "sub_name": "Local Account"
        },
        {
          "id": "T1123",
          "name": "Audio Capture"
        },
        {
          "id": "T1115",
          "name": "Clipboard Data"
        },
        {
          "id": "T1555",
          "name": "Credentials from Password Stores"
        },
        {
          "parent_id": "T1555",
          "id": "003",
          "name": "Credentials from Password Stores",
          "sub_name": "Credentials from Web Browsers"
        },
        {
          "id": "T1213",
          "name": "Data from Information Repositories"
        },
        {
          "id": "T1005",
          "name": "Data from Local System"
        },
        {
          "id": "T1025",
          "name": "Data from Removable Media"
        },
        {
          "id": "T1482",
          "name": "Domain Trust Discovery"
        },
        {
          "parent_id": "T1056",
          "id": "001",
          "name": "Input Capture",
          "sub_name": "Keylogging"
        },
        {
          "id": "T1046",
          "name": "Network Service Discovery"
        },
        {
          "id": "T1003",
          "name": "OS Credential Dumping"
        },
        {
          "id": "T1057",
          "name": "Process Discovery"
        },
        {
          "id": "T1018",
          "name": "Remote System Discovery"
        },
        {
          "id": "T1539",
          "name": "Steal Web Session Cookie"
        },
        {
          "id": "T1033",
          "name": "System Owner/User Discovery"
        }
      ]
    },
    {
      "id": "S1147",
      "name": "Nightdoor",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) uses [Nightdoor](https://attack.mitre.org/software/S1147) as a backdoor mechanism for Windows hosts.(Citation: ESET EvasivePanda 2024)(Citation: Symantec Daggerfly 2024)",
      "techniques": [
        {
          "id": "T1071",
          "name": "Application Layer Protocol"
        },
        {
          "parent_id": "T1059",
          "id": "003",
          "name": "Command and Scripting Interpreter",
          "sub_name": "Windows Command Shell"
        },
        {
          "id": "T1140",
          "name": "Deobfuscate/Decode Files or Information"
        },
        {
          "id": "T1574",
          "name": "Hijack Execution Flow"
        },
        {
          "parent_id": "T1070",
          "id": "004",
          "name": "Indicator Removal",
          "sub_name": "File Deletion"
        },
        {
          "id": "T1057",
          "name": "Process Discovery"
        },
        {
          "parent_id": "T1053",
          "id": "005",
          "name": "Scheduled Task/Job",
          "sub_name": "Scheduled Task"
        },
        {
          "id": "T1082",
          "name": "System Information Discovery"
        },
        {
          "id": "T1016",
          "name": "System Network Configuration Discovery"
        },
        {
          "id": "T1033",
          "name": "System Owner/User Discovery"
        },
        {
          "id": "T1124",
          "name": "System Time Discovery"
        },
        {
          "parent_id": "T1497",
          "id": "001",
          "name": "Virtualization/Sandbox Evasion",
          "sub_name": "System Checks"
        },
        {
          "id": "T1102",
          "name": "Web Service"
        }
      ]
    },
    {
      "id": "S0013",
      "name": "PlugX",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has used [PlugX](https://attack.mitre.org/software/S0013) loaders as part of intrusions.(Citation: Symantec Daggerfly 2023)",
      "techniques": [
        {
          "parent_id": "T1071",
          "id": "001",
          "name": "Application Layer Protocol",
          "sub_name": "Web Protocols"
        },
        {
          "parent_id": "T1071",
          "id": "004",
          "name": "Application Layer Protocol",
          "sub_name": "DNS"
        },
        {
          "parent_id": "T1547",
          "id": "001",
          "name": "Boot or Logon Autostart Execution",
          "sub_name": "Registry Run Keys / Startup Folder"
        },
        {
          "parent_id": "T1059",
          "id": "003",
          "name": "Command and Scripting Interpreter",
          "sub_name": "Windows Command Shell"
        },
        {
          "parent_id": "T1543",
          "id": "003",
          "name": "Create or Modify System Process",
          "sub_name": "Windows Service"
        },
        {
          "id": "T1140",
          "name": "Deobfuscate/Decode Files or Information"
        },
        {
          "parent_id": "T1573",
          "id": "001",
          "name": "Encrypted Channel",
          "sub_name": "Symmetric Cryptography"
        },
        {
          "id": "T1083",
          "name": "File and Directory Discovery"
        },
        {
          "parent_id": "T1564",
          "id": "001",
          "name": "Hide Artifacts",
          "sub_name": "Hidden Files and Directories"
        },
        {
          "parent_id": "T1574",
          "id": "001",
          "name": "Hijack Execution Flow",
          "sub_name": "DLL"
        },
        {
          "parent_id": "T1562",
          "id": "004",
          "name": "Impair Defenses",
          "sub_name": "Disable or Modify System Firewall"
        },
        {
          "id": "T1105",
          "name": "Ingress Tool Transfer"
        },
        {
          "parent_id": "T1056",
          "id": "001",
          "name": "Input Capture",
          "sub_name": "Keylogging"
        },
        {
          "parent_id": "T1036",
          "id": "004",
          "name": "Masquerading",
          "sub_name": "Masquerade Task or Service"
        },
        {
          "parent_id": "T1036",
          "id": "005",
          "name": "Masquerading",
          "sub_name": "Match Legitimate Resource Name or Location"
        },
        {
          "id": "T1112",
          "name": "Modify Registry"
        },
        {
          "id": "T1106",
          "name": "Native API"
        },
        {
          "id": "T1135",
          "name": "Network Share Discovery"
        },
        {
          "id": "T1095",
          "name": "Non-Application Layer Protocol"
        },
        {
          "id": "T1571",
          "name": "Non-Standard Port"
        },
        {
          "id": "T1027",
          "name": "Obfuscated Files or Information"
        },
        {
          "id": "T1057",
          "name": "Process Discovery"
        },
        {
          "id": "T1012",
          "name": "Query Registry"
        },
        {
          "id": "T1113",
          "name": "Screen Capture"
        },
        {
          "id": "T1049",
          "name": "System Network Connections Discovery"
        },
        {
          "parent_id": "T1127",
          "id": "001",
          "name": "Trusted Developer Utilities Proxy Execution",
          "sub_name": "MSBuild"
        },
        {
          "parent_id": "T1497",
          "id": "001",
          "name": "Virtualization/Sandbox Evasion",
          "sub_name": "System Checks"
        },
        {
          "parent_id": "T1102",
          "id": "001",
          "name": "Web Service",
          "sub_name": "Dead Drop Resolver"
        }
      ]
    },
    {
      "id": "S0075",
      "name": "Reg",
      "descr": "[Daggerfly](https://attack.mitre.org/groups/G1034) has used [Reg](https://attack.mitre.org/software/S0075) to dump various Windows registry hives from victim machines.(Citation: Symantec Daggerfly 2023)",
      "techniques": [
        {
          "id": "T1112",
          "name": "Modify Registry"
        },
        {
          "id": "T1012",
          "name": "Query Registry"
        },
        {
          "parent_id": "T1552",
          "id": "002",
          "name": "Unsecured Credentials",
          "sub_name": "Credentials in Registry"
        }
      ]
    }
  ],
  "add_software_ref": true,
  "alias_descriptions": [
    {
      "name": "Evasive Panda",
      "descr": "(Citation: Symantec Daggerfly 2023)(Citation: ESET EvasivePanda 2024)"
    },
    {
      "name": "BRONZE HIGHLAND",
      "descr": "(Citation: Symantec Daggerfly 2023)(Citation: ESET EvasivePanda 2024)"
    }
  ],
  "citations": {
    "current_number": 0,
    "ESET EvasivePanda 2024": {
      "description": "Ahn Ho, Facundo Muñoz, & Marc-Etienne M.Léveillé. (2024, March 7). Evasive Panda leverages Monlam Festival to target Tibetans. Retrieved July 25, 2024.",
      "number": null,
      "url": "https://www.welivesecurity.com/en/eset-research/evasive-panda-leverages-monlam-festival-target-tibetans/"
    },
    "ESET EvasivePanda 2023": {
      "description": "Facundo Muñoz. (2023, April 26). Evasive Panda APT group delivers malware via updates for popular Chinese software. Retrieved July 25, 2024.",
      "number": null,
      "url": "https://www.welivesecurity.com/2023/04/26/evasive-panda-apt-group-malware-updates-popular-chinese-software/"
    },
    "Symantec Daggerfly 2023": {
      "description": "Threat Hunter Team. (2023, April 20). Daggerfly: APT Actor Targets Telecoms Company in Africa. Retrieved July 25, 2024.",
      "number": null,
      "url": "https://symantec-enterprise-blogs.security.com/threat-intelligence/apt-attacks-telecoms-africa-mgbot"
    },
    "Symantec Daggerfly 2024": {
      "description": "Threat Hunter Team. (2024, July 23). Daggerfly: Espionage Group Makes Major Update to Toolset. Retrieved July 25, 2024.",
      "number": null,
      "url": "https://symantec-enterprise-blogs.security.com/threat-intelligence/daggerfly-espionage-updated-toolset"
    }
  },
  "aliases_list": [
    "Evasive Panda",
    "BRONZE HIGHLAND"
  ]
}