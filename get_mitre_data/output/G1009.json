{
  "attack_id": "G1009",
  "notes": null,
  "created": "11 August 2022",
  "modified": "11 April 2024",
  "name": "Moses Staff",
  "version": "2.0",
  "contributors_list": [
    "Hiroki Nagahama, NEC Corporation",
    "Pooja Natarajan, NEC Corporation India",
    "Manikantan Srinivasan, NEC Corporation India"
  ],
  "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) is a suspected Iranian threat group that has primarily targeted Israeli companies since at least September 2021. [Moses Staff](https://attack.mitre.org/groups/G1009) openly stated their motivation in attacking Israeli companies is to cause damage by leaking stolen sensitive data and encrypting the victim's networks without a ransom demand.(Citation: Checkpoint MosesStaff Nov 2021) \n\nSecurity researchers assess [Moses Staff](https://attack.mitre.org/groups/G1009) is politically motivated, and has targeted government, finance, travel, energy, manufacturing, and utility companies outside of Israel as well, including those in Italy, India, Germany, Chile, Turkey, the UAE, and the US.(Citation: Cybereason StrifeWater Feb 2022)",
  "technique_table_data": [
    {
      "domain": "enterprise",
      "id": "T1087",
      "name": "Account Discovery",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "001",
          "name": "Local Account",
          "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has collected the administrator username from a compromised host.(Citation: Checkpoint MosesStaff Nov 2021)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1587",
      "name": "Develop Capabilities",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "001",
          "name": "Malware",
          "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has built malware, such as [DCSrv](https://attack.mitre.org/software/S1033) and [PyDCrypt](https://attack.mitre.org/software/S1032), for targeting victims' machines.(Citation: Checkpoint MosesStaff Nov 2021)",
          "subtechniques": []
        }
      ]
    },
    {
      "technique_used": true,
      "domain": "enterprise",
      "id": "T1190",
      "name": "Exploit Public-Facing Application",
      "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has exploited known vulnerabilities in public-facing infrastructure such as Microsoft Exchange Servers.(Citation: Checkpoint MosesStaff Nov 2021)",
      "subtechniques": []
    },
    {
      "domain": "enterprise",
      "id": "T1562",
      "name": "Impair Defenses",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "004",
          "name": "Disable or Modify System Firewall",
          "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has used batch scripts that can disable the Windows firewall on specific remote machines.(Citation: Checkpoint MosesStaff Nov 2021)",
          "subtechniques": []
        }
      ]
    },
    {
      "technique_used": true,
      "domain": "enterprise",
      "id": "T1105",
      "name": "Ingress Tool Transfer",
      "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has downloaded and installed web shells to following path <code>C:\\inetpub\\wwwroot\\aspnet_client\\system_web\\IISpool.aspx</code>.(Citation: Checkpoint MosesStaff Nov 2021)",
      "subtechniques": []
    },
    {
      "domain": "enterprise",
      "id": "T1027",
      "name": "Obfuscated Files or Information",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "013",
          "name": "Encrypted/Encoded File",
          "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has used obfuscated web shells in their operations.(Citation: Checkpoint MosesStaff Nov 2021)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1588",
      "name": "Obtain Capabilities",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "002",
          "name": "Tool",
          "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has used the commercial tool DiskCryptor.(Citation: Checkpoint MosesStaff Nov 2021)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1021",
      "name": "Remote Services",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "002",
          "name": "SMB/Windows Admin Shares",
          "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has used batch scripts that can enable SMB on a compromised host.(Citation: Checkpoint MosesStaff Nov 2021)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1505",
      "name": "Server Software Component",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "003",
          "name": "Web Shell",
          "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has dropped a web shell onto a compromised system.(Citation: Checkpoint MosesStaff Nov 2021)",
          "subtechniques": []
        }
      ]
    },
    {
      "domain": "enterprise",
      "id": "T1553",
      "name": "Subvert Trust Controls",
      "technique_used": false,
      "subtechniques": [
        {
          "technique_used": true,
          "domain": "enterprise",
          "id": "002",
          "name": "Code Signing",
          "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has used signed drivers from an open source tool called DiskCryptor to evade detection.(Citation: Checkpoint MosesStaff Nov 2021)",
          "subtechniques": []
        }
      ]
    },
    {
      "technique_used": true,
      "domain": "enterprise",
      "id": "T1082",
      "name": "System Information Discovery",
      "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) collected information about the infected host, including the machine names and OS architecture.(Citation: Checkpoint MosesStaff Nov 2021)\n",
      "subtechniques": []
    },
    {
      "technique_used": true,
      "domain": "enterprise",
      "id": "T1016",
      "name": "System Network Configuration Discovery",
      "descr": "[Moses Staff](https://attack.mitre.org/groups/G1009) has collected the domain name of a compromised network.(Citation: Checkpoint MosesStaff Nov 2021)",
      "subtechniques": []
    }
  ],
  "campaign_data": [],
  "add_campaign_ref": false,
  "software_data": [
    {
      "id": "S1033",
      "name": "DCSrv",
      "descr": "(Citation: Checkpoint MosesStaff Nov 2021)",
      "techniques": [
        {
          "parent_id": "T1543",
          "id": "003",
          "name": "Create or Modify System Process",
          "sub_name": "Windows Service"
        },
        {
          "id": "T1486",
          "name": "Data Encrypted for Impact"
        },
        {
          "parent_id": "T1036",
          "id": "004",
          "name": "Masquerading",
          "sub_name": "Masquerade Task or Service"
        },
        {
          "id": "T1112",
          "name": "Modify Registry"
        },
        {
          "id": "T1106",
          "name": "Native API"
        },
        {
          "parent_id": "T1027",
          "id": "013",
          "name": "Obfuscated Files or Information",
          "sub_name": "Encrypted/Encoded File"
        },
        {
          "id": "T1529",
          "name": "System Shutdown/Reboot"
        },
        {
          "id": "T1124",
          "name": "System Time Discovery"
        }
      ]
    },
    {
      "id": "S0029",
      "name": "PsExec",
      "descr": "(Citation: Checkpoint MosesStaff Nov 2021)",
      "techniques": [
        {
          "parent_id": "T1136",
          "id": "002",
          "name": "Create Account",
          "sub_name": "Domain Account"
        },
        {
          "parent_id": "T1543",
          "id": "003",
          "name": "Create or Modify System Process",
          "sub_name": "Windows Service"
        },
        {
          "id": "T1570",
          "name": "Lateral Tool Transfer"
        },
        {
          "parent_id": "T1021",
          "id": "002",
          "name": "Remote Services",
          "sub_name": "SMB/Windows Admin Shares"
        },
        {
          "parent_id": "T1569",
          "id": "002",
          "name": "System Services",
          "sub_name": "Service Execution"
        }
      ]
    },
    {
      "id": "S1032",
      "name": "PyDCrypt",
      "descr": "(Citation: Checkpoint MosesStaff Nov 2021)",
      "techniques": [
        {
          "parent_id": "T1059",
          "id": "006",
          "name": "Command and Scripting Interpreter",
          "sub_name": "Python"
        },
        {
          "parent_id": "T1059",
          "id": "003",
          "name": "Command and Scripting Interpreter",
          "sub_name": "Windows Command Shell"
        },
        {
          "parent_id": "T1059",
          "id": "001",
          "name": "Command and Scripting Interpreter",
          "sub_name": "PowerShell"
        },
        {
          "id": "T1140",
          "name": "Deobfuscate/Decode Files or Information"
        },
        {
          "parent_id": "T1562",
          "id": "004",
          "name": "Impair Defenses",
          "sub_name": "Disable or Modify System Firewall"
        },
        {
          "parent_id": "T1070",
          "id": "004",
          "name": "Indicator Removal",
          "sub_name": "File Deletion"
        },
        {
          "parent_id": "T1036",
          "id": "005",
          "name": "Masquerading",
          "sub_name": "Match Legitimate Resource Name or Location"
        },
        {
          "parent_id": "T1027",
          "id": "013",
          "name": "Obfuscated Files or Information",
          "sub_name": "Encrypted/Encoded File"
        },
        {
          "id": "T1049",
          "name": "System Network Connections Discovery"
        },
        {
          "id": "T1033",
          "name": "System Owner/User Discovery"
        },
        {
          "id": "T1047",
          "name": "Windows Management Instrumentation"
        }
      ]
    },
    {
      "id": "S1034",
      "name": "StrifeWater",
      "descr": "(Citation: Cybereason StrifeWater Feb 2022)",
      "techniques": [
        {
          "parent_id": "T1059",
          "id": "003",
          "name": "Command and Scripting Interpreter",
          "sub_name": "Windows Command Shell"
        },
        {
          "id": "T1005",
          "name": "Data from Local System"
        },
        {
          "parent_id": "T1573",
          "id": "001",
          "name": "Encrypted Channel",
          "sub_name": "Symmetric Cryptography"
        },
        {
          "id": "T1041",
          "name": "Exfiltration Over C2 Channel"
        },
        {
          "id": "T1083",
          "name": "File and Directory Discovery"
        },
        {
          "parent_id": "T1070",
          "id": "004",
          "name": "Indicator Removal",
          "sub_name": "File Deletion"
        },
        {
          "id": "T1105",
          "name": "Ingress Tool Transfer"
        },
        {
          "parent_id": "T1036",
          "id": "005",
          "name": "Masquerading",
          "sub_name": "Match Legitimate Resource Name or Location"
        },
        {
          "id": "T1106",
          "name": "Native API"
        },
        {
          "id": "T1053",
          "name": "Scheduled Task/Job"
        },
        {
          "id": "T1113",
          "name": "Screen Capture"
        },
        {
          "id": "T1082",
          "name": "System Information Discovery"
        },
        {
          "id": "T1033",
          "name": "System Owner/User Discovery"
        },
        {
          "id": "T1124",
          "name": "System Time Discovery"
        },
        {
          "parent_id": "T1497",
          "id": "003",
          "name": "Virtualization/Sandbox Evasion",
          "sub_name": "Time Based Evasion"
        }
      ]
    }
  ],
  "add_software_ref": true,
  "alias_descriptions": [
    {
      "name": "DEV-0500",
      "descr": "(Citation: Microsoft Threat Actor Naming July 2023)"
    },
    {
      "name": "Marigold Sandstorm",
      "descr": "(Citation: Microsoft Threat Actor Naming July 2023)"
    }
  ],
  "citations": {
    "current_number": 0,
    "Checkpoint MosesStaff Nov 2021": {
      "description": "Checkpoint Research. (2021, November 15). Uncovering MosesStaff techniques: Ideology over Money. Retrieved August 11, 2022.",
      "number": null,
      "url": "https://research.checkpoint.com/2021/mosesstaff-targeting-israeli-companies/"
    },
    "Cybereason StrifeWater Feb 2022": {
      "description": "Cybereason Nocturnus. (2022, February 1). StrifeWater RAT: Iranian APT Moses Staff Adds New Trojan to Ransomware Operations. Retrieved August 15, 2022.",
      "number": null,
      "url": "https://www.cybereason.com/blog/research/strifewater-rat-iranian-apt-moses-staff-adds-new-trojan-to-ransomware-operations"
    },
    "Microsoft Threat Actor Naming July 2023": {
      "description": "Microsoft . (2023, July 12). How Microsoft names threat actors. Retrieved November 17, 2023.",
      "number": null,
      "url": "https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/microsoft-threat-actor-naming?view=o365-worldwide"
    }
  },
  "aliases_list": [
    "DEV-0500",
    "Marigold Sandstorm"
  ]
}